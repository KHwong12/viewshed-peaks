var Oe=Object.defineProperty,Ae=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var de=(e,t,i)=>t in e?Oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,J=(e,t)=>{for(var i in t||(t={}))Le.call(t,i)&&de(e,i,t[i]);if(ce)for(var i of ce(t))Te.call(t,i)&&de(e,i,t[i]);return e},X=(e,t)=>Ae(e,Ve(t));import{r as n,t as o,w as I,z as E,aq as y,dX as Q,iP as Ie,hK as Ee,iQ as $e,iR as ue,ah as Se,iS as Re,iT as Pe,iU as ze,E as O,hH as $,ej as He,aT as B,iV as De,iW as te,iX as xe,iY as ie,A as g,a5 as je,fI as Ge,hn as se,aS as W,gl as he,a4 as ye,q as Fe,au as Ue,u as ne,aG as Y,an as S,el as q,iZ as N,d as Be,c$ as pe,ak as ge,hz as Ne,i_ as ve,cB as k,i2 as m,en as ke,i$ as Me,bf as K,j0 as _e,aH as G,ap as We,j1 as me,i3 as R,j2 as fe,j3 as qe,bA as Ke,j4 as Ze,C as u,P as Je,K as M,iM as f,cG as Xe,cu as Qe,dz as Ye}from"./vendor.d423bc92.js";import{m as oe,p as et}from"./LineVisualElement.cd39013a.js";let D=class extends E{constructor(e){super(e),this.elevationAlignedTargetLocation=null,this.inputPoints={isValid:!1,observer:y(),observerSurfaceNormal:null,target:y(),targetSurfaceNormal:null,observerAdjusted:y(),targetAdjusted:y()},this.computationResult={start:y(),end:y(),intersection:y(),isValid:!1,isTargetVisible:!1},this.result=null}updateComputationResults(){this.notifyChange("computationResult")}updateInputPoints(){this.notifyChange("inputPoints")}onElevationChange(){this.notifyChange("elevationAlignedTargetLocation")}};n([o()],D.prototype,"target",void 0),n([o()],D.prototype,"elevationAlignedTargetLocation",void 0),n([o()],D.prototype,"inputPoints",void 0),n([o()],D.prototype,"computationResult",void 0),n([o()],D.prototype,"result",void 0),D=n([I("esri.views.3d.analysis.LineOfSight.LineOfSightAnalysis")],D);var re;let L=re=class extends E{constructor(e){super(e)}clone(){return new re({type:this.type,id:Q(this.id),point:Q(this.point),normal:Q(this.normal),ray:Q(this.ray)})}equals(e){return this.type===e.type&&this.id===e.id&&Ie(this.point,e.point)&&Ee(this.normal,e.normal)&&$e(this.ray,e.ray)}};n([o()],L.prototype,"type",void 0),n([o({constructOnly:!0})],L.prototype,"id",void 0),n([o({constructOnly:!0})],L.prototype,"point",void 0),n([o({constructOnly:!0})],L.prototype,"normal",void 0),n([o({constructOnly:!0})],L.prototype,"ray",void 0),L=re=n([I("esri.views.3d.analysis.LineOfSight.LineOfSightIntersectionResult")],L);let Z=class extends E{constructor(e){super(e)}initialize(){this.intersector=Se(this.view.state.viewingMode),this.intersector.options.hud=!1,this.intersector.options.store=0}getScreenPointIntersection(e){const t=Re(e,Pe.get()),i=ze(this.view.state.camera,t,le);return this._getRayIntersection(i)}_getRayIntersection(e){if(O(e))return null;this.view.sceneIntersectionHelper.intersectToolIntersectorRay(e,this.intersector);const t=this.intersector.results.min;if(!t.getIntersectionPoint(ae))return null;const i=this.view.renderCoordsHelper.fromRenderCoords(ae,this.view.spatialReference),s=$(t.normal),r=He(s,e.direction)>0?-1:1;if(B(s,s,r),De(t))return new L({type:0,id:`${t.target.layerUid}/${t.target.nodeIndex}/${t.target.componentIndex}`,point:i,normal:s,ray:te(e)});if(xe(t))return new L({type:2,id:t.target.lij.slice(),point:i,normal:s,ray:te(e)});const l=ie(t,this.view);if(g(l)){const a=l.layer,d=l.sourceLayer;let h;return d&&d.type==="scene"?h=je(l,d.objectIdField):h=l.uid,new L({type:0,id:`${a.uid}/${h}`,point:i,normal:s,ray:te(e)})}return null}_canUpdateFromIntersectionResult(e,t){if(O(e)||!t||e.type!==t.type)return!1;switch(e.type){case 2:{const i=e.id,s=t.id;return i[0]===s[0]&&i[1]===s[1]&&i[2]===s[2]||Ge(i,s)}case 0:case 4:return e.id===t.id}}updateFromIntersectionResult(e){let t;if(e.type===2&&g(e.point)){const i=ae,s=tt,r=it;this.view.renderCoordsHelper.toRenderCoords(e.point,s),this.view.renderCoordsHelper.worldUpAtPosition(s,r);const l=this.view.basemapTerrain.elevationBounds,a=this.view.renderCoordsHelper.getAltitude(s),d=l?Math.abs(l.max-l.min)/Math.abs(a):100,h=a>0?1:-1;se(r,r),B(r,r,h*d),W(i,s,r),he(i,s,le),t=this._getRayIntersection(le)}else t=this._getRayIntersection(e.ray);return this._canUpdateFromIntersectionResult(t,e)?t.point:null}};n([o()],Z.prototype,"view",void 0),n([o()],Z.prototype,"intersector",void 0),Z=n([I("esri.views.3d.analysis.LineOfSight.LineOfSightRayIntersector")],Z);const ae=y(),tt=y(),it=y(),le=ue();let x=class extends E{constructor(e){super(e),this.target=null,this.intersectedGraphic=null,this.intersectedLocation=null,this.elevationAlignedTargetLocation=null}};n([o()],x.prototype,"target",void 0),n([o()],x.prototype,"intersectedGraphic",void 0),n([o()],x.prototype,"intersectedLocation",void 0),n([o()],x.prototype,"elevationAlignedTargetLocation",void 0),n([o()],x.prototype,"visible",void 0),x=n([I("esri.views.3d.analysis.LineOfSight.LineOfSightResult")],x);let C=class extends ye.EventedMixin(E){constructor(e){super(e),this._updatingHandles=new Fe,this._frameTask=Ue,this._handles=new ne,this._analysisHandles=new ne}initialize(){var e;const t=(e=this.view.resourceController)==null?void 0:e.scheduler;t&&(this._frameTask=t.registerTask(Y.LINE_OF_SIGHT_TOOL)),this._handles.add([this._connectObserver(),this._connectAnalyses(),this._connectTargets()]),this._intersector=new Z({view:this.view})}destroy(){this._handles.destroy(),this._analysisHandles.destroy(),this._analyses.removeAll(),this._updatingHandles.destroy()}get updating(){return this._frameTask.updating||this._updatingHandles.updating}get priority(){return this._frameTask.priority}set priority(e){this._frameTask.priority=e}get _analyses(){return this.analysisViewData.analyses}get _observerEngineLocation(){return this.analysisViewData.observerEngineLocation}set _observerEngineLocation(e){this.analysisViewData.observerEngineLocation=e}get _screenPixelSize(){return this.view.state.camera.computeScreenPixelSizeAt(this._observerEngineLocation)}getLineOfSightComputationDependencies(e){const{inputPoints:t}=e;return{inputPoints:t}}computeAnalysis(e){const t=e.analysis,{inputPoints:i,computationResult:s}=t,{observerAdjusted:r,targetAdjusted:l}=i,{start:a,end:d}=s;S(a,r),S(d,l),this._canComputeAnalysis(t)?this._computeAnalysisIntersection(e):this._interpolateAnalysisIntersection(e),t.updateComputationResults(),this.emit("result-changed",{target:e.analysis.target,result:t.result})}_adjustStartEndPositions(e){const t=this._screenPixelSize,i=this.view,{inputPoints:s}=e,{observer:r,observerSurfaceNormal:l,target:a,targetSurfaceNormal:d,observerAdjusted:h,targetAdjusted:_}=s,c=ee;g(l)?S(c,l):q(c,a,r);const v=t;se(c,c),B(c,c,Math.min(v,1)),W(h,r,c),g(d)?S(c,d):q(c,r,a);const V=i.state.camera.computeScreenPixelSizeAt(a);se(c,c),B(c,c,Math.min(V,1)),W(_,a,c)}_computeAnalysisIntersection({analysis:e,interpolationInfo:t}){const{view:i}=this,{sceneIntersectionHelper:s,renderCoordsHelper:r}=i;if(O(s))return;const l=this._intersector.intersector,{computationResult:a,inputPoints:d}=e,{observer:h,target:_}=d,{start:c,end:v}=a,V=he(c,v,nt);s.intersectToolIntersectorRay(V,l);const P=a.intersection,F=ee,U=l.results.min.getIntersectionPoint(P);let p=!0;if(U){S(t.originalIntersection,P),S(t.originalObserver,c),S(t.originalTarget,v),r.fromRenderCoords(P,F,i.spatialReference);const b=1-N(v,_)/N(c,_);p=N(h,P)>=b*N(h,_)}const z=new Be(F,i.spatialReference);{const{result:b,target:H}=e;g(b)?(b.target=H,b.intersectedGraphic=p?null:ie(l.results.min,i),b.intersectedLocation=p?null:z,b.visible=!!U&&p):e.result=new x({target:H,elevationAlignedTargetLocation:e.elevationAlignedTargetLocation,intersectedGraphic:p?null:ie(l.results.min,i),intersectedLocation:p?null:z,visible:!!U&&p})}a.isValid=d.isValid=!0,a.isTargetVisible=p}_interpolateAnalysisIntersection({analysis:e,interpolationInfo:t}){const{computationResult:i,inputPoints:s}=e,{start:r,end:l,intersection:a}=i,{originalIntersection:d,originalObserver:h,originalTarget:_}=t;if(S(a,d),s.isValid){const c=ee,v=N(h,d)/N(h,_);pe(c,r,h),B(c,c,1-v),W(a,a,c),pe(c,l,_),B(c,c,v),W(a,a,c),i.isValid=!0}else e.result=null,i.isValid=!1,i.isTargetVisible=!1}_canComputeAnalysis(e){const t=this.analysisViewData.elevationAlignedObserver,i=this.view.frustum;if(O(t)||O(e.target)||O(i))return!1;const{observerAdjusted:s,targetAdjusted:r}=e.inputPoints,l=i.intersectsPoint(s),a=i.intersectsPoint(r);return l&&a}_onObserverChange(e,t){if(O(e))return this.analysis.targets.removeAll(),void(this.analysisViewData.elevationAlignedObserver=null);this.analysisViewData.elevationAlignedObserver=this._applyElevationAlignment(e,t);const i=y();this.view.renderCoordsHelper.toRenderCoords(this.analysisViewData.elevationAlignedObserver,i),this._observerEngineLocation=i,this.priority=Y.LINE_OF_SIGHT_TOOL_INTERACTIVE}_applyElevationAlignment(e,t){if(e.hasZ&&(O(t)||t.type===0))return e;const i=e.clone();return i.z=ge(Ne(this.view.elevationProvider,i),0),i}_onObserverChangeForAnalysis(e){e.inputPoints.isValid=!1}_onObserverEngineForAnalysis(e,t,i){const{inputPoints:s}=e;if(S(s.observer,t),g(i)){const r=this._intersector.updateFromIntersectionResult(i);g(r)&&this.view.renderCoordsHelper.toRenderCoords(r,s.observer),s.observerSurfaceNormal=ve(i.normal)}else s.observerSurfaceNormal=null;this._adjustStartEndPositions(e),e.updateInputPoints(),this.priority=Y.LINE_OF_SIGHT_TOOL_INTERACTIVE}_onTargetLocationChange(e,t,i){const s=e.inputPoints;if(s.isValid=!1,g(t)){if(e.elevationAlignedTargetLocation=this._applyElevationAlignment(t,i),this.view.renderCoordsHelper.toRenderCoords(e.elevationAlignedTargetLocation,s.target),g(i)){const r=this._intersector.updateFromIntersectionResult(i);g(r)&&this.view.renderCoordsHelper.toRenderCoords(r,s.target),s.targetSurfaceNormal=ve(i.normal)}else s.targetSurfaceNormal=null;this._adjustStartEndPositions(e),e.updateInputPoints()}this.priority=Y.LINE_OF_SIGHT_TOOL_INTERACTIVE}_connectAnalysisToTarget(e){return k([m(()=>e.target.location,t=>{be(t,e.target.intersection)||(e.target.intersection=null)},me),m(()=>({analysis:e,targetLocation:e.target.location,targetIntersection:e.target.intersection}),({analysis:t,targetLocation:i,targetIntersection:s})=>{g(i)&&this._onTargetLocationChange(t,i,s)},R)])}_connectAnalysisToObserver(e){return m(()=>({analysis:e,observer:this.analysisViewData.elevationAlignedObserver}),({analysis:t})=>{this._onObserverChangeForAnalysis(t)},R)}_connectAnalysisToObserverEngine(e){return m(()=>({analysis:e,observer:this._observerEngineLocation,observerIntersection:this.analysis.intersection}),({analysis:t,observer:i,observerIntersection:s})=>{this._onObserverEngineForAnalysis(t,i,s)},R)}_connectAnalysisToCamera(e){return m(()=>({camera:this.view.state.camera,isDirty:this._isCameraDirty}),({isDirty:t})=>{e.inputPoints.isValid&&!t||e.updateInputPoints()},fe)}_connectAnalysisToElevation(e){return this.view.elevationProvider.on("elevation-change",t=>{if(!this._canComputeAnalysis(e))return;const i=this.analysis.observer;Ce(t.extent,t.spatialReference,i)&&this._onObserverChange(i,this.analysis.intersection);const s=e.target;g(s)&&Ce(t.extent,t.spatialReference,s.location)&&e.onElevationChange()})}_connectAnalysisForCompute(e){let t=qe;const i={analysis:e,interpolationInfo:{originalIntersection:y(),originalObserver:y(),originalTarget:y()}};return k([m(()=>this.getLineOfSightComputationDependencies(e),()=>{t=_e(t),t=Ke(async s=>{await Ze(this._frameTask.schedule(()=>this.computeAnalysis(i),s))})},R),K(()=>t=_e(t))])}_connectAnalysis(e){const t=this._analysisHandles;t.has(e)||t.add([this._connectAnalysisToTarget(e),this._connectAnalysisToObserver(e),this._connectAnalysisToObserverEngine(e),this._connectAnalysisToCamera(e),this._connectAnalysisToElevation(e),this._connectAnalysisForCompute(e)],e)}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_onAnalysesCollectionChange(e){e.added.forEach(t=>this._connectAnalysis(t)),e.removed.forEach(t=>this._disconnectAnalysis(t))}_onTargetsChange(){return this._analyses.removeAll(),this.analysis.targets.forEach(e=>this._addTarget(e)),this._updatingHandles.addOnCollectionPropertyChange(this.analysis,"targets",e=>this._onTargetCollectionChange(e))}_onTargetCollectionChange(e){e.added.forEach(t=>this._addTarget(t)),e.removed.forEach(t=>this._removeTarget(t))}_onCursorTargetChange(e,t){g(t)&&this._removeTarget(t),g(e)&&this._addTarget(e)}_addTarget(e){this._analyses.some(t=>t.target===e)||this._analyses.add(new D({target:e}))}_removeTarget(e){const t=this._analyses.find(i=>i.target===e);this._analyses.remove(t)}_connectObserver(){return k([m(()=>this.analysis.observer,e=>{be(e,this.analysis.intersection)||(this.analysis.intersection=null)},me),m(()=>({observer:this.analysis.observer,intersection:this.analysis.intersection}),({observer:e,intersection:t})=>this._onObserverChange(e,t),R)])}_connectAnalyses(){let e=null;return k([m(()=>this._analyses,()=>{G(e),e=this._updatingHandles.addOnCollectionPropertyChange(this,"_analyses",t=>this._onAnalysesCollectionChange(t)),this._analyses.forEach(t=>this._connectAnalysis(t))},R),K(()=>e=G(e))])}_connectTargets(){let e=null;return k([m(()=>this.analysis.targets,()=>{e=G(e),e=this._onTargetsChange()},R),m(()=>this.analysisViewData.cursorTarget,(t,i)=>{this._onCursorTargetChange(t,i)}),K(()=>{e=G(e)})])}get _isCameraDirty(){const e=this.analysisViewData.elevationAlignedObserver,{view:t}=this,{renderCoordsHelper:i}=t;if(O(e)||O(i))return!1;const s=ee;i.toRenderCoords(e,s);const r=t.state.camera.computeScreenPixelSizeAt(s);return Math.abs((r-this._screenPixelSize)/this._screenPixelSize)>st}};function Ce(e,t,i){return!O(i)&&(ke(e,t,we,i.spatialReference),Me(we,i))}function be(e,t){return O(t)||g(e)&&e.equals(t.point)}n([o({constructOnly:!0})],C.prototype,"analysis",void 0),n([o({constructOnly:!0})],C.prototype,"analysisViewData",void 0),n([o({constructOnly:!0})],C.prototype,"view",void 0),n([o()],C.prototype,"updating",null),n([o()],C.prototype,"priority",null),n([o()],C.prototype,"_analyses",null),n([o()],C.prototype,"_observerEngineLocation",null),n([o()],C.prototype,"_screenPixelSize",null),n([o({readOnly:!0})],C.prototype,"_updatingHandles",void 0),n([o()],C.prototype,"_frameTask",void 0),n([o()],C.prototype,"_isCameraDirty",null),C=n([I("esri.views.3d.analysis.LineOfSight.LineOfSightController")],C);const st=.1,ee=y(),nt=ue(),we=We();let A=class extends E{constructor(e){super(e),this.innerWidth=2,this.outerWidth=8,this.visibleInnerColor=new u([3,252,111,1]),this.visibleOuterColor=new u([3,252,111,.15]),this.occludedInnerColor=new u([252,3,69,1]),this.occludedOuterColor=new u([252,3,69,.1]),this.undefinedInnerColor=new u([255,255,255,1]),this.undefinedOuterColor=new u([127,127,127,.2])}};n([o({type:Number})],A.prototype,"innerWidth",void 0),n([o({type:Number})],A.prototype,"outerWidth",void 0),n([o({type:u})],A.prototype,"visibleInnerColor",void 0),n([o({type:u})],A.prototype,"visibleOuterColor",void 0),n([o({type:u})],A.prototype,"occludedInnerColor",void 0),n([o({type:u})],A.prototype,"occludedOuterColor",void 0),n([o({type:u})],A.prototype,"undefinedInnerColor",void 0),n([o({type:u})],A.prototype,"undefinedOuterColor",void 0),A=n([I("esri.views.3d.analysis.LineOfSight.LineOfSightConfiguration")],A);let j=class extends E{constructor(){super(...arguments),this.analyses=new Je,this.elevationAlignedObserver=null,this.configuration=new A,this.observerEngineLocation=y(),this.cursorTarget=null}};n([o()],j.prototype,"analyses",void 0),n([o()],j.prototype,"elevationAlignedObserver",void 0),n([o({type:A})],j.prototype,"configuration",void 0),n([o()],j.prototype,"observerEngineLocation",void 0),n([o()],j.prototype,"cursorTarget",void 0),j=n([I("esri.views.3d.analysis.LineOfSight.LineOfSightViewData")],j);let T=class extends E{constructor(e){super(e),this._handle=null,this._analysisHandles=new ne}initialize(){this._handle=this._connectAnalyses()}destroy(){this._handle=G(this._handle),this._analysisHandles=M(this._analysisHandles)}get visible(){return this.analysisView.visible&&!this.analysisView.suspended}get _analyses(){return this.analysisView.analysisViewData.analyses}get _configuration(){return this.analysisView.analysisViewData.configuration}get _opacity(){return this.analysisView.fullOpacity}createLineOfSightVisualization(){const e=this._configuration,t=this._opacity,i={view:this.view,attached:!0,width:e.outerWidth,innerWidth:e.innerWidth},s=u.toUnitRGBA(e.visibleOuterColor);f(s,s,t);const r=u.toUnitRGBA(e.visibleInnerColor);f(r,r,t);const l=u.toUnitRGBA(e.occludedOuterColor);f(l,l,t);const a=u.toUnitRGBA(e.occludedInnerColor);f(a,a,t);const d=u.toUnitRGBA(e.undefinedOuterColor);f(d,d,t);const h=u.toUnitRGBA(e.undefinedInnerColor);return f(h,h,t),{visibleLineVisualElement:new oe(X(J({},i),{color:s,innerColor:r})),occludedLineVisualElement:new oe(X(J({},i),{color:l,innerColor:a})),undefinedLineVisualElement:new oe(X(J({},i),{color:d,innerColor:h}))}}destroyLineOfSightVisualization(e){e.visibleLineVisualElement=M(e.visibleLineVisualElement),e.occludedLineVisualElement=M(e.occludedLineVisualElement),e.undefinedLineVisualElement=M(e.undefinedLineVisualElement)}updateLineOfSightVisualization(e,t){const i=this.visible,s=this._configuration,{computationResult:r,inputPoints:l}=e,{start:a,end:d,intersection:h,isValid:_,isTargetVisible:c}=r,{observer:v}=l,V=lt;V[12]=v[0],V[13]=v[1],V[14]=v[2];const P=q(ot,a,v),F=q(rt,d,v),U=q(at,h,v),{visibleLineVisualElement:p,occludedLineVisualElement:z,undefinedLineVisualElement:b}=t;if(!i)return p.visible=!1,z.visible=!1,void(b.visible=!1);if(p.visible=!0,z.visible=!0,b.visible=!0,p.geometry=null,z.geometry=null,b.geometry=null,_)if(c){p.geometry=[[$(P),$(F)]],p.transform=V;const H=u.toUnitRGBA(s.visibleOuterColor);p.color=f(H,H,this._opacity)}else{p.geometry=[[$(P),$(U)]],p.transform=V;const H=u.toUnitRGBA(s.occludedOuterColor);p.color=f(H,H,this._opacity),z.geometry=[[$(U),$(F)]],z.transform=V}else b.geometry=[[$(P),$(F)]],b.transform=V}updateVisualizationOpacity(e,t){const i=this._configuration,s=this._opacity,r=u.toUnitRGBA(i.visibleOuterColor);f(r,r,s);const l=u.toUnitRGBA(i.visibleInnerColor);f(l,l,s);const a=u.toUnitRGBA(i.occludedOuterColor);f(a,a,s);const d=u.toUnitRGBA(i.occludedInnerColor);f(d,d,s);const h=u.toUnitRGBA(i.undefinedOuterColor);f(h,h,s);const _=u.toUnitRGBA(i.undefinedInnerColor);f(_,_,s),t.visibleLineVisualElement.color=e.computationResult.isTargetVisible?r:a,t.visibleLineVisualElement.innerColor=l,t.occludedLineVisualElement.color=a,t.occludedLineVisualElement.innerColor=d,t.undefinedLineVisualElement.color=h,t.undefinedLineVisualElement.innerColor=_}getLineOfSightVisualizationDependencies(e){const{computationResult:t}=e,{occludedOuterColor:i,visibleOuterColor:s}=this._configuration;return{computationResult:t,occludedOuterColor:i,visibleOuterColor:s,visible:this.visible}}_connectAnalysis(e){const t=this._analysisHandles;if(t.has(e))return;const i=this.createLineOfSightVisualization();t.add([m(()=>this.getLineOfSightVisualizationDependencies(e),()=>this.updateLineOfSightVisualization(e,i),R),m(()=>this._opacity,()=>this.updateVisualizationOpacity(e,i),fe),K(()=>this.destroyLineOfSightVisualization(i))],e)}_disconnectAnalysis(e){this._analysisHandles.remove(e)}_connectAnalyses(){let e=null;return k([m(()=>this._analyses,t=>{e=G(e),e=t.on("change",i=>this._onAnalysesCollectionChange(i)),this._onAnalysesCollectionChange({target:t,added:t.items,removed:[],moved:[]})},R),K(()=>e=G(e))])}_onAnalysesCollectionChange(e){e.added.forEach(t=>this._connectAnalysis(t)),e.removed.forEach(t=>this._disconnectAnalysis(t))}};n([o({constructOnly:!0})],T.prototype,"analysis",void 0),n([o({constructOnly:!0})],T.prototype,"analysisView",void 0),n([o({constructOnly:!0})],T.prototype,"view",void 0),n([o({readOnly:!0})],T.prototype,"visible",null),n([o()],T.prototype,"_analyses",null),n([o()],T.prototype,"_configuration",null),n([o()],T.prototype,"_opacity",null),T=n([I("esri.views.3d.analysis.LineOfSight.LineOfSightVisualization")],T);const ot=y(),rt=y(),at=y(),lt=Xe();let w=class extends et(Qe(ye.EventedMixin(E))){constructor(e){super(e),this.type="line-of-sight-view",this.suspended=!1,this.fullOpacity=1,this.analysisViewData=new j}initialize(){const e=this.view,t=this.analysis;this._analysisController=new C({analysis:t,analysisViewData:this.analysisViewData,view:e}),this._analysisVisualization=new T({analysis:t,analysisView:this,view:e}),this.handles.add([this._analysisController.on("result-changed",i=>{i.target!==this.analysisViewData.cursorTarget&&this.emit("result-changed",i)})])}destroy(){this._analysisController=M(this._analysisController),this._analysisVisualization=M(this._analysisVisualization)}get results(){return this.analysisViewData.analyses.map(e=>e.result)}get priority(){return this._analysisController.priority}set priority(e){this._analysisController.priority=e}get updating(){return g(this._analysisController)&&this._analysisController.updating}getResultForTarget(e){const t=this.analysisViewData.analyses.find(s=>s.target===e),i=Ye(t,s=>s.result);return ge(i,null)}get test(){return{visualization:this._analysisVisualization,controller:this._analysisController}}};n([o()],w.prototype,"type",void 0),n([o()],w.prototype,"analysis",void 0),n([o({readOnly:!0})],w.prototype,"results",null),n([o()],w.prototype,"priority",null),n([o()],w.prototype,"suspended",void 0),n([o()],w.prototype,"fullOpacity",void 0),n([o()],w.prototype,"analysisViewData",void 0),n([o()],w.prototype,"updating",null),n([o()],w.prototype,"_analysisController",void 0),n([o()],w.prototype,"_analysisVisualization",void 0),w=n([I("esri.views.3d.analysis.LineOfSight.LineOfSightView3D")],w);const ht=w;export{ht as default};
