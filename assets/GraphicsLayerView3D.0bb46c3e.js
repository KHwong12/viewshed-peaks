import{bh as h,bi as p,fC as n,r as a,w as d,fJ as u,e as s,d as r,i as l,F as c}from"./index.89a7b683.js";import{c as o}from"./Graphics3DFrustumVisibility.d6305daa.js";import{E as g}from"./Graphics3DGraphicLikeLayerView.8488fca3.js";import{l as y}from"./projectExtentUtils.c2292b8f.js";import"./Graphics3DScaleVisibility.bc09a75c.js";import"./optimizedFeatureQueryEngineAdapter.14be8206.js";import"./centroid.2275fb3f.js";import"./PooledRBush.d52fd1e0.js";import"./quickselect.32614045.js";import"./Graphics3DObjectStates.53e927e5.js";const m=1.2;let e=class extends h(p){constructor(){super(...arguments),this.type="graphics-3d",this.frustumVisibility=new o,this.slicePlaneEnabled=!1,this.drapeSourceType=1,this.suspendResumeExtent=null,this.fullExtentInLocalViewSpatialReference=null}initialize(){this._set("graphics3d",new g({owner:this,layer:this.layer,scaleVisibilityEnabled:!0})),this.graphics3d.setup(),this.frustumVisibility.setup(this),this.setupSuspendResumeExtent(),this.updatingHandles.add(this,"fullOpacity",()=>this.graphics3d.graphicsCore.opacityChange()),this.handles.add(this.layer.on("graphic-update",i=>this.graphics3d.graphicsCore.graphicUpdateHandler(i))),this.addResolvingPromise(y(this).then(i=>this.fullExtentInLocalViewSpatialReference=i)),this.layer.internal?this.notifyChange("updating"):this.handles.add(n(this.view,"basemapTerrain.ready",()=>this.notifyChange("updating")))}destroy(){this.frustumVisibility&&(this.frustumVisibility.destroy(),this._set("frustumVisibility",null)),this.graphics3d&&(this.graphics3d.destroy(),this._set("graphics3d",null))}get legendEnabled(){return this.canResume()&&!this.frustumVisibility.suspended}get suspendInfo(){var i;const t={};return a(this.graphics3d.scaleVisibility)&&this.graphics3d.scaleVisibility.suspended&&(t.outsideScaleRange=!0),t.outsideOfView=!((i=this.frustumVisibility)==null||!i.suspended),t}async fetchPopupFeatures(i,t){return a(t)?t.clientGraphics:null}notifyGraphicGeometryChanged(i){this.graphics3d.graphicsCore.notifyGraphicGeometryChanged(i)}notifyGraphicVisibilityChanged(i){this.graphics3d.graphicsCore.notifyGraphicVisibilityChanged(i)}get graphics3DGraphics(){return this.graphics3d.graphicsCore.graphics3DGraphics}get graphics3DGraphicsByObjectID(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphicsByObjectID:null}get symbolUpdateType(){return this.graphics3d.graphicsCore.symbolUpdateType}getGraphicFromGraphicUid(i){return this.graphics3d.getGraphicFromGraphicUid(i)}whenGraphicBounds(i,t){return this.graphics3d.whenGraphicBounds(i,t)}computeAttachmentOrigin(i,t){return this.graphics3d?this.graphics3d.graphicsCore.computeAttachmentOrigin(i,t):null}getSymbolLayerSize(i,t){return this.graphics3d.getSymbolLayerSize(i,t)}queryGraphics(){return Promise.resolve(this.loadedGraphics)}maskOccludee(i){return this.graphics3d.maskOccludee(i)}highlight(i){return this.graphics3d.highlight(i)}get updatePolicy(){var i;return((i=this.graphics3d)==null?void 0:i.graphicsCore.effectiveUpdatePolicy)||1}canResume(){var i;return super.canResume()&&!((i=this.graphics3d)!=null&&i.suspended)}isUpdating(){var i,t;return!(!(this.graphics3d&&this.graphics3d.updating||this.frustumVisibility&&this.frustumVisibility.updating)&&(this.layer.internal||(i=this.view)!=null&&(t=i.basemapTerrain)!=null&&t.ready))}setupSuspendResumeExtent(){const i=()=>{this.suspendResumeExtent=c(this.graphics3d.graphicsCore.computedExtent,this.suspendResumeExtent,m,this.graphics3d.graphicsCore.extentPadding),this.frustumVisibility.setExtent(this.suspendResumeExtent)};d(this.graphics3d.graphicsCore,"computedExtent",()=>i(),!0),u(this.graphics3d.graphicsCore,"extentPadding",()=>i(),!0)}get performanceInfo(){return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:-1,totalNumberOfFeatures:-1,nodes:0,core:null,updating:this.updating,elevationUpdating:this.graphics3d.elevationAlignment.updating,visibilityFrustum:!this.frustumVisibility.suspended}}};s([r({aliasOf:"layer.graphics"})],e.prototype,"loadedGraphics",void 0),s([r({readOnly:!0})],e.prototype,"suspended",void 0),s([r({readOnly:!0})],e.prototype,"legendEnabled",null),s([r({readOnly:!0})],e.prototype,"updating",void 0),s([r()],e.prototype,"layer",void 0),s([r({readOnly:!0})],e.prototype,"frustumVisibility",void 0),s([r({readOnly:!0})],e.prototype,"graphics3d",void 0),s([r({type:Boolean})],e.prototype,"slicePlaneEnabled",void 0),s([r({readOnly:!0})],e.prototype,"suspendInfo",null),e=s([l("esri.views.3d.layers.GraphicsLayerView3D")],e);const R=e;export{R as default};
